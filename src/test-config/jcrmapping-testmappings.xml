<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE graffito-jcr PUBLIC "-//The Apache Software Foundation//DTD Repository//EN" "./src/dtd/graffito-jcr-mapping.dtd">
<graffito-jcr>
    
  
	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.Folder" jcrNodeType="nt:unstructured">
		<!-- Field-descriptor is used to map simple attributes to jcr property -->
		<field-descriptor fieldName="path" path="true" />
		<field-descriptor fieldName="name" jcrName="name" />
		<field-descriptor fieldName="description" jcrName="description" />
		<field-descriptor fieldName="title" jcrName="title" />
		<field-descriptor fieldName="creationDate" jcrName="creationDate" />
		<field-descriptor fieldName="lastModified" jcrName="lastModified" />

	</class-descriptor>

	<!--
		The following classes are used to test object associations
		A has an assocition (1..1) with B (field b) => B is mapped as subnode in A
		A has a collection of C (field "collection" ) => there are n subnodes used to map the "C" collection 
		
	-->
	<class-descriptor
		className="org.apache.portals.graffito.jcr.testmodel.A"
		jcrNodeType="nt:unstructured"
		jcrMixinTypes="mixin:a,mixin:b">
		<!-- Field-descriptor is used to map simple attributes to jcr property -->
		<field-descriptor fieldName="path" path="true" />
		<field-descriptor fieldName="a1" jcrName="a1" />
		<field-descriptor fieldName="a2" jcrName="a2" />

		<!-- bean-descriptor is used to map a bean into subnode
			* The definition of the associated class has to be defined in this mapping file 
			* proxy="true" => use lazy laoding for this attribute b when retrieving A
		-->
		<bean-descriptor fieldName="b" 
						 jcrName="b" 
						 proxy="false" 
						 inline="true"
						 jcrNodeType="nt:unstructured"
        				 jcrAutoCreated="false" 
        				 jcrMandatory="false" 
        				 jcrOnParentVersion="IGNORE"
        				 jcrProtected="false" 
        				 jcrSameNameSiblings="false" />

		<!-- 
			Use the default collection mapping stategy and the default collection type (can be a Vector, an ArrayList, a Collection or a List) 
			The default collection mapping strategy map a collection under an extra JCR node (specify by the jcrName).
			
		-->
		<collection-descriptor fieldName="collection" jcrName="collection" proxy="false"
        elementClassName="org.apache.portals.graffito.jcr.testmodel.C" jcrNodeType="graffito:C"
        jcrAutoCreated="false" jcrMandatory="false" jcrOnParentVersion="IGNORE"
        jcrProtected="false" jcrSameNameSiblings="false"/>
        
		<collection-descriptor fieldName="emptyCollection" jcrName="emptyCollection" proxy="false"
        elementClassName="org.apache.portals.graffito.jcr.testmodel.C" />
		
	</class-descriptor>

	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.B"  jcrNodeType="nt:unstructured" jcrSuperTypes="nt:base">
		<!-- Field-descriptor is used to map simple attributes to jcr property -->

		<field-descriptor fieldName="b1" jcrName="b1" jcrType="String" jcrAutoCreated="false" jcrMandatory="false"
        jcrOnParentVersion="IGNORE" jcrProtected="false" jcrMultiple="false" />
		
        <field-descriptor fieldName="b2" jcrName="b2" jcrType="String" jcrAutoCreated="true" jcrMandatory="true"
        jcrOnParentVersion="COPY" jcrProtected="true" jcrMultiple="true" />

	</class-descriptor>

	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.C" jcrNodeType="graffito:C">
		<!-- Field-descriptor is used to map simple attributes to jcr property -->
		<field-descriptor fieldName="id" jcrName="graffito:id" 	id="true" />
		<field-descriptor fieldName="name" jcrName="graffito:name" />
	</class-descriptor>


	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.Page" jcrNodeType="graffito:page">
		<field-descriptor fieldName="path" path="true" />
		<field-descriptor fieldName="title" jcrName="graffito:title" />
		<collection-descriptor fieldName="paragraphs" proxy="false" 
		                       elementClassName="org.apache.portals.graffito.jcr.testmodel.Paragraph" 
		                       collectionConverter="org.apache.portals.graffito.jcr.persistence.collectionconverter.impl.NTCollectionConverterImpl" />
	</class-descriptor>

	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.Paragraph" jcrNodeType="graffito:paragraph">
		<field-descriptor fieldName="path" path="true" />
		<field-descriptor fieldName="text" jcrName="graffito:text"/>
	</class-descriptor>


	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.hashmap.Main" jcrNodeType="nt:unstructured">
		<field-descriptor fieldName="path" path="true" />
		<field-descriptor fieldName="text" jcrName="text" />
		<collection-descriptor fieldName="elements" proxy="false" 
		                       elementClassName="org.apache.portals.graffito.jcr.testmodel.hashmap.Element" 
		                       collectionConverter="org.apache.portals.graffito.jcr.persistence.collectionconverter.impl.NTCollectionConverterImpl" 
		                       collectionClassName="org.apache.portals.graffito.jcr.testmodel.hashmap.HashMapElement" />
		                       
	</class-descriptor>

	<class-descriptor className="org.apache.portals.graffito.jcr.testmodel.hashmap.Element" jcrNodeType="graffito:element">
		<field-descriptor fieldName="id" jcrName="graffito:id"  />
		<field-descriptor fieldName="text" jcrName="graffito:text" />
	</class-descriptor>
</graffito-jcr>
 